<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" xmlns:tal="http://xml.zope.org/namespaces/tal">

<head>
    <title>Munin-Collector Display Metrics</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <meta name="keywords" content="python web application" />
    <meta name="description" content="pyramid web application" />
    <link rel="shortcut icon" href="${request.static_url('munincollector:static/favicon.ico')}" />
    <link rel="stylesheet" href="${request.static_url('munincollector:static/pylons.css')}" type="text/css" media="screen" charset="utf-8" />
    <link rel="stylesheet" href="http://static.pylonsproject.org/fonts/nobile/stylesheet.css" media="screen">
    <link rel="stylesheet" href="http://static.pylonsproject.org/fonts/neuton/stylesheet.css" media="screen">
    <script type="text/javascript" src="${request.static_url('munincollector:static/show.js')}"></script>

    <!--[if lte IE 6]>
    <link rel="stylesheet" href="${request.static_url('munincollector:static/ie6.css')}" type="text/css" media="screen" charset="utf-8" />
    <![endif]-->

<script type="text/javascript">
window.onload = function() {
    SetCBs();
    CountCBs();
    DisableDisabled();

    if (document.getElementById("to").disabled == false && document.getElementById("to").value > 0) {
        var timeout = setTimeout("document.getElementById('selections').submit()", document.getElementById("to").value * 1000);
        }
</script>
</head>

<body>
    <div id="middle" class="middle align-center">
        <p class="app-welcome">
            <span class="app-name">Munin-Collector:</span> An application to collect and present statistics.
            <!-- <br>${str(request.params)} -->
        </p>
    </div><!--id="middle"-->

    <div id="content" class="bottom">
        <form id=ShowForm> <!--form id=selections-->

            <input type="hidden" id="h1" name="h1" value="${Options['h1']['value']}" />
            <input type="hidden" id="h2" name="h2" value="${Options['h2']['value']}" />

            <h2 onclick="ToggleDisplay('graph-section');">Show graphs (${len(Selections)})</h2>
            <div id="graph-section">    

                <div tal:condition="Options['if']['value']=='CSV'">
                    <div tal:repeat="csv Selections">
                        &nbsp; &nbsp; &nbsp;
                        <a href="${request.static_url('munincollector:static/munin/')}${csv[1]}">${csv[0]}</a>
                    </div>
                </div>

                <div tal:condition="Options['if']['value']!='CSV'">
                    <table cellspacing="10">
                        <div tal:repeat="graph Selections">
                            <tr tal:condition="repeat.graph.index%Options['gc']['value']==0"/>
                            <td>
                                <span onclick="ToggleDisplay('graph-section');">${graph[0]}</span>
                                <br/><img onclick="ToggleDisplay('graph-section');" src="${request.static_url('munincollector:static/munin/')}${graph[1]}"/>
                            </td>
                        </div>
                    </table>
                </div>

            </div><!-- id="graph-section"-->

            <h2>Make Selections:</h2>

            <input onclick="SetH2();" type="button" value="Change Order" id="B1"/>
            <input onclick="FormReset();" type="button" value="Reset Selections" id="B2"/>
            <input onclick="SetH2();" type="submit" value="Refresh selected resources (n)" id="selected-resources"/>

            <!-- Create two seletion lists, one ordered by hosts and the other ordered by plugins. The web page will
                 display only one of the lists at a time; the user may choose which one. In either case, the lists
                 contain expandable sub-elements, which are not displayed by default.
            -->
            <div id="s1-select">    
                <!-- Create the host ordered list with the following format:

                     <host>
                        <plugin>
                        <plugin>
                            <mgid>
                            <mgid>
                            <mgid>
                        <plugin>
                     <host>
                          .
                          .
                -->

                <ul id="s1-list" class="links">
                    <li tal:repeat="host sorted(Hosts)">
                        <input onclick="ToggleChildCBs('${Xref[0].index(host)}');" id="${Xref[0].index(host)}" type="checkbox" />
                        <span onclick="ToggleDisplay('s1.${Xref[0].index(host)}');">
                            ${host}
                            <span tal:condition="len(PluginConfigs['links'][host])>1">(${len(PluginConfigs['links'][host])})</span>
                        </span>

                            <div style="display:none" id="s1.${Xref[0].index(host)}">    
                                <ul class="links">
                                    <li tal:repeat="plugin sorted(Hosts[host]['plugins'])">
                                        &nbsp; &nbsp; &nbsp;
                                        <input onclick="ToggleChildCBs('${Xref[0].index(host)}.${Xref[1].index(plugin)}');" id="${Xref[0].index(host)}.${Xref[1].index(plugin)}" type="checkbox" />
                                        <span onclick="ToggleDisplay('s1.${Xref[0].index(host)}.${Xref[1].index(plugin)}');">
                                            ${plugin}
                                            <span tal:condition="len(Hosts[host]['plugins'][plugin]['mgids'])>1">(${len(Hosts[host]['plugins'][plugin]['mgids'])})</span>
                                        </span>

                                            <div tal:condition="len(Hosts[host]['plugins'][plugin]['mgids'])>1">
                                                <div style="display:none" id="s1.${Xref[0].index(host)}.${Xref[1].index(plugin)}">
                                                    <ul class="links">
                                                        <li tal:repeat="mgid sorted(Hosts[host]['plugins'][plugin]['mgids'])">
                                                            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                                            <input onclick="ToggleChildCBs('${Xref[0].index(host)}.${Xref[1].index(plugin)}.${Xref[2].index(mgid)}');" id="${Xref[0].index(host)}.${Xref[1].index(plugin)}.${Xref[2].index(mgid)}" type="checkbox" />
                                                            <span onclick="ToggleDisplay('s1.${Xref[0].index(host)}.${Xref[1].index(plugin)}');">
                                                                ${mgid}
                                                            </span>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>

                                    </li>
                                </ul>
                            </div>
                   </li>
                </ul>
            </div><!--id="s1-select"-->

            <div id="s2-select">    
                <!-- Create the plugin ordered list with the following format:

                     <plugin>
                        <host>
                        <host>
                        <host>
                     <plugin>
                        <host>
                        <host>
                     <plugin>
                        <mgid>
                            <host>
                            <host>
                        <mgid>
                            <host>
                            <host>
                            <host>
                          .
                          .
                -->
                <ul id="s2-list" class="links">
                    <!-- Create the plugin level -->
                    <li tal:repeat="plugin sorted(Plugins)">
                        <input onclick="ToggleChildCBs('c2.${Xref[1].index(plugin)}');" id="c2.${Xref[1].index(plugin)}" type="checkbox" />
                        <span onclick="ToggleDisplay('s2.${Xref[1].index(plugin)}');">
                            ${plugin}
                            <span tal:condition="len(Plugins[plugin]['mgids'])>1"/>(${len(Plugins[plugin]['mgids'])}/${len(Plugins[plugin]['hosts'])})
                            <span tal:condition="len(Plugins[plugin]['mgids'])<2"/>(/${len(Plugins[plugin]['hosts'])})
                        </span>

                        <div tal:condition="len(Plugins[plugin]['mgids'])>1">
                            <!-- Create the mgid level -->
                            <div style="display:none" id="s2.${Xref[1].index(plugin)}">    
                                <ul class="links">
                                    <li tal:repeat="mgid sorted(Plugins[plugin]['mgids'])">
                                        &nbsp; &nbsp; &nbsp;
                                        <input onclick="ToggleChildCBs('c2.${Xref[1].index(plugin)}.c2.${Xref[2].index(mgid)}');" id="c2.${Xref[1].index(plugin)}.c2.${Xref[2].index(mgid)}" type="checkbox" />
                                        <span onclick="ToggleDisplay('s2.${Xref[1].index(plugin)}.s2.${Xref[2].index(mgid)}');">
                                            ${mgid}
                                            (${len(Plugins[plugin]['hosts'])})
                                        </span>

                                            <div style="display:none" id="s2.${Xref[1].index(plugin)}.s2.${Xref[2].index(mgid)}">    
                                                <!-- Create the host level -->
                                                <ul class="links">
                                                    <li tal:repeat="host sorted(Plugins[plugin]['mgids'][mgid])">
                                                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                                        <input onclick="ToggleChildCBs('c2.${Xref[1].index(plugin)}.${Xref[0].index(host)}.${Xref[2].index(mgid)}');" id="c2.${Xref[1].index(plugin)}.${Xref[0].index(host)}.${Xref[2].index(mgid)}" type="checkbox" />
                                                        <span onclick="ToggleDisplay('s2.${Xref[1].index(plugin)}.s2.${Xref[2].index(mgid)}');">
                                                            ${host}
                                                        </span>
                                                    </li>
                                                </ul>
                                            </div>

                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div tal:condition="len(Plugins[plugin]['mgids'])<2">
                            <!-- No mgids for this plugin, create the host level -->
                            <div style="display:none" id="s2.${Xref[1].index(plugin)}">    
                                <ul class="links">
                                    <li tal:repeat="host sorted(Plugins[plugin]['mgids'][mgid])">
                                        &nbsp; &nbsp; &nbsp;
                                        <input onclick="ToggleChildCBs('c2.${Xref[1].index(plugin)}.${Xref[0].index(host)}.${Xref[2].index(mgid)}');" id="c2.${Xref[1].index(plugin)}.${Xref[0].index(host)}.${Xref[2].index(mgid)}" type="checkbox" />
                                        <span onclick="ToggleDisplay('s2.${Xref[1].index(plugin)}');">
                                            ${host}
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>

<!--
                    </li>
                </ul>
-->
            </div><!--id="s2-select"-->

        <br>

        <h2>Options:</h2>
        <div id="options-section">    
             <p>Click a label to enable or disable the corresponding option; double-click for option help.</p>
             <div id="left">
                <br><span onclick="EnableDisable('ta','ta');" ondblclick="OptionHelp('Absolute Start Time: Specifies the number of seconds since the Linux epoch (1 Jan 1970, 00:00:00) for the origin of the \'x\' axis. If omitted, the value will be calculated from the Relative Start Time.');">Absolute Start Time</span>

                <br><span onclick="EnableDisable('tr','tr');" ondblclick="OptionHelp('Time Range: Specifies the number of hours represented by the \'x\' axis. The default value is 30, but a decimal value in the range of .5 to 100000 can be specified.');">Relative Start Time/Time Range</span>

                <br><span onclick="EnableDisable('to','to');" ondblclick="OptionHelp('Timeout: Specifies the number of seconds before graphs and the display are to be refreshed. The default value is 300, but a decimal value in the range of 60 to 3600 can be specified.');">Time Out</span>

                <br>
                <br><span onclick="EnableDisable('ht','ht');" ondblclick="OptionHelp('Height: Specifies the height of the graph in pixels. The default value is 600, but a decimal value in the range of 100 to 2400 can be specified.');">Height</span>

                <br><span onclick="EnableDisable('wd','wd');" ondblclick="OptionHelp('Width: Specifies the width of the graph in pixels. The default value is 1200, but a decimal value in the range of 100 to 2400 can be specified.');">Width</span>

                <br><span onclick="EnableDisable('ft','ft');" ondblclick="OptionHelp('Title Font Size: Specifies the size of the fonts to be used for the graph title. The default value is 8, but a decimal value in the range of 6 to 32 can be specified.');">Title Font Size</span>
                <br><span onclick="EnableDisable('fa','fa');" ondblclick="OptionHelp('Axis Font Size: Specifies the size of the fonts to be used for the unit markers on the 'X' and 'Y' axes. The default value is 8, but a decimal value in the range of 6 to 32 can be specified.');">Axis Font Size</span>
                <br><span onclick="EnableDisable('fv','fv');" ondblclick="OptionHelp('Vertical Label Font Size: Specifies the size of the fonts to be used for the 'Y' axis label. The default value is 8, but a decimal value in the range of 6 to 32 can be specified.');">Vertical Label Font Size</span>
                <br><span onclick="EnableDisable('fs','fs');" ondblclick="OptionHelp('Legend and Statistics Font Size: Specifies the size of the fonts to be used for both the graph\'s legend and the graph\'s statistics. The default value is 8, but a decimal value in the range of 0 to 32 can be specified. Specifying a value less then 6 disables statistics and they will not be displayed on the graphs. Specifying a value of 0 will display no statistics but the legend will use font size 8.');">Statistics Font Size</span>
                <br><span onclick="EnableDisable('gc','gc');" ondblclick="OptionHelp('Graph Display Columns: Specifies the number of graphs in a row to be displayed on the web page. The default value is 1, but a decimal value in the range of 1 to 24 can be specified.');">Graph Display Columns</span>

                <br>
                <br><span onclick="EnableDisable('gt','gt');" ondblclick="OptionHelp('Title: Specify a title text string to be used for all graphs generated. By default, a unique graph title is defined by the originating Munin plugin.');">Title</span>

                <br>
                <br><span ondblclick="OptionHelp('Image Fromat: Default is PNG.');">Image Format</span>

            </div>

            <div id="right">
                <br><input type="text" id="ta" name="${Options['ta']['disabled']}" value="${Options['ta']['value']}" size=16 />
                <br><input type="text" id="tr" name="${Options['tr']['disabled']}" value="${Options['tr']['value']}" size=16 />
                <br><input type="text" id="to" name="${Options['to']['disabled']}" value="${Options['to']['value']}" size=8 />
                <br>
                <br><input type="text" id="ht" name="${Options['ht']['disabled']}" value="${Options['ht']['value']}" size=8 />
                <br><input type="text" id="wd" name="${Options['wd']['disabled']}" value="${Options['wd']['value']}" size=8 />
                <br><input type="text" id="ft" name="${Options['ft']['disabled']}" value="${Options['ft']['value']}" size=8 />
                <br><input type="text" id="fa" name="${Options['fa']['disabled']}" value="${Options['fa']['value']}" size=8 />
                <br><input type="text" id="fv" name="${Options['fv']['disabled']}" value="${Options['fv']['value']}" size=8 />
                <br><input type="text" id="fs" name="${Options['fs']['disabled']}" value="${Options['fs']['value']}" size=8 />
                <br><input type="text" id="gc" name="${Options['gc']['disabled']}" value="${Options['gc']['value']}" size=8 />
                <br>
                <br><input type="text" id="gt" name="${Options['gt']['disabled']}" value="${Options['gt']['value']}" size=32 />
                <br><br>
                    <div tal:condition="Options['if']['value']=='PNG'">
                        <input type="radio" name="if" value="PNG" checked/>PNG
                        <input type="radio" name="if" value="SVG"/>SVG
                        <input type="radio" name="if" value="CSV"/>CSV
                    </div>

                    <div tal:condition="Options['if']['value']=='SVG'">
                        <input type="radio" name="if" value="PNG"/>PNG
                        <input type="radio" name="if" value="SVG" checked/>SVG
                        <input type="radio" name="if" value="CSV"/>CSV
                    </div>

                    <div tal:condition="Options['if']['value']=='CSV'">
                        <input type="radio" name="if" value="PNG"/>PNG
                        <input type="radio" name="if" value="SVG"/>SVG
                        <input type="radio" name="if" value="CSV" checked/>CSV
                    </div>

                <br><br><br><br>
            </div>
        </div><!-- id="options-section"-->

<!--
        </form>
    </div><!--id="content"-->
-->

    <br><br><br><br>

    <div id="footer">
        <div class="footer">&copy; Copyright 2011, University of Victoria.</div>
    </div>
</body>
</html>

